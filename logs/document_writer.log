2025-01-23 23:07:01.417 | ERROR    | src.services.research:search:39 - Error parsing Tavily response with dirtyjson: Expecting value: line 1 column 66 (char 65)
2025-01-23 23:07:01.417 | INFO     | src.services.document:save_version:109 - Saved document version to _workproduct\01_initial_research_latest_news_from_ukraine_war_20250123_230701.md
2025-01-23 23:07:01.421 | ERROR    | src.agents.judge:review_document:103 - Error during document review: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-23 23:07:01.422 | ERROR    | src.document_writer:expansion_loop:90 - Error in expansion loop: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-23 23:07:01.423 | ERROR    | src.document_writer:process_document:154 - Error during document processing: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-23 23:07:01.425 | ERROR    | __main__:create_document:57 - Error in document creation
Traceback (most recent call last):

  File "c:\Users\kevin\repos\document_writer\src\main.py", line 102, in <module>
    main()
    └ <function main at 0x0000021D115E4AE0>

  File "c:\Users\kevin\repos\document_writer\src\main.py", line 92, in main
    create_document()
    └ <function create_document at 0x0000021D115E49A0>

> File "c:\Users\kevin\repos\document_writer\src\main.py", line 54, in create_document
    asyncio.run(writer.process_document(topic))
    │       │   │      │                └ 'latest news from Ukraine war'
    │       │   │      └ <function DocumentWriter.process_document at 0x0000021D115E4860>
    │       │   └ <src.document_writer.DocumentWriter object at 0x0000021D113797D0>
    │       └ <function run at 0x0000021D0E240EA0>
    └ <module 'asyncio' from 'C:\\Users\\kevin\\AppData\\Roaming\\uv\\python\\cpython-3.11.11-windows-x86_64-none\\Lib\\asyncio\\__...

  File "C:\Users\kevin\AppData\Roaming\uv\python\cpython-3.11.11-windows-x86_64-none\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object DocumentWriter.process_document at 0x0000021D115C6680>
           │      └ <function Runner.run at 0x0000021D0E2C4FE0>
           └ <asyncio.runners.Runner object at 0x0000021D115E1810>
  File "C:\Users\kevin\AppData\Roaming\uv\python\cpython-3.11.11-windows-x86_64-none\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │                        └ <Task finished name='Task-1' coro=<DocumentWriter.process_document() done, defined at C:\Users\kevin\repos\document_writer\sr...
           │    └ None
           └ <asyncio.runners.Runner object at 0x0000021D115E1810>
  File "C:\Users\kevin\AppData\Roaming\uv\python\cpython-3.11.11-windows-x86_64-none\Lib\asyncio\base_events.py", line 654, in run_until_complete
    return future.result()
           │      └ <method 'result' of '_asyncio.Task' objects>
           └ <Task finished name='Task-1' coro=<DocumentWriter.process_document() done, defined at C:\Users\kevin\repos\document_writer\sr...

  File "C:\Users\kevin\repos\document_writer\src\document_writer.py", line 143, in process_document
    while await self.expansion_loop(doc_state):
                │    │              └ DocumentState(content="\n## Content from Ukraine war latest: 'Extremely fierce battles' as Kyiv's troops try to ...\n\nThe ma...
                │    └ <function DocumentWriter.expansion_loop at 0x0000021D115E4720>
                └ <src.document_writer.DocumentWriter object at 0x0000021D113797D0>

  File "C:\Users\kevin\repos\document_writer\src\document_writer.py", line 68, in expansion_loop
    feedback = await self.judge_agent.review_document(doc_state, EditorResponse(
                     │    │           │               │          └ <class 'src.models.EditorResponse'>
                     │    │           │               └ DocumentState(content="\n## Content from Ukraine war latest: 'Extremely fierce battles' as Kyiv's troops try to ...\n\nThe ma...
                     │    │           └ <function JudgeAgent.review_document at 0x0000021D115C2980>
                     │    └ <src.agents.judge.JudgeAgent object at 0x0000021D115E2110>
                     └ <src.document_writer.DocumentWriter object at 0x0000021D113797D0>

  File "C:\Users\kevin\repos\document_writer\src\agents\judge.py", line 58, in review_document
    response = await openai.ChatCompletion.acreate(
                     │      └ APIRemovedInV1Proxy
                     └ <module 'openai' from 'C:\\Users\\kevin\\repos\\document_writer\\.venv\\Lib\\site-packages\\openai\\__init__.py'>

  File "C:\Users\kevin\repos\document_writer\.venv\Lib\site-packages\openai\lib\_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
          │                     │    └ 'ChatCompletion'
          │                     └ APIRemovedInV1Proxy
          └ <class 'openai.lib._old_api.APIRemovedInV1'>

openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-23 23:14:38.976 | INFO     | src.services.document:save_version:109 - Saved document version to _workproduct\01_initial_research_latest_news_from_ukraine_war_20250123_231438.md
2025-01-23 23:14:41.138 | ERROR    | src.agents.judge:review_document:93 - Error during document review: Error code: 400 - {'error': {'message': "Missing required parameter: 'response_format.json_schema'.", 'type': 'invalid_request_error', 'param': 'response_format.json_schema', 'code': 'missing_required_parameter'}}
2025-01-23 23:14:41.148 | ERROR    | src.document_writer:expansion_loop:90 - Error in expansion loop: Error code: 400 - {'error': {'message': "Missing required parameter: 'response_format.json_schema'.", 'type': 'invalid_request_error', 'param': 'response_format.json_schema', 'code': 'missing_required_parameter'}}
2025-01-23 23:14:41.148 | ERROR    | src.document_writer:process_document:154 - Error during document processing: Error code: 400 - {'error': {'message': "Missing required parameter: 'response_format.json_schema'.", 'type': 'invalid_request_error', 'param': 'response_format.json_schema', 'code': 'missing_required_parameter'}}
2025-01-23 23:14:41.148 | ERROR    | __main__:create_document:57 - Error in document creation
Traceback (most recent call last):

  File "c:\Users\kevin\repos\document_writer\src\main.py", line 102, in <module>
    main()
    └ <function main at 0x0000014FE71D3060>

  File "c:\Users\kevin\repos\document_writer\src\main.py", line 92, in main
    create_document()
    └ <function create_document at 0x0000014FE71D2F20>

> File "c:\Users\kevin\repos\document_writer\src\main.py", line 54, in create_document
    asyncio.run(writer.process_document(topic))
    │       │   │      │                └ 'latest news from ukraine war'
    │       │   │      └ <function DocumentWriter.process_document at 0x0000014FE71D2DE0>
    │       │   └ <src.document_writer.DocumentWriter object at 0x0000014FE6F80F10>
    │       └ <function run at 0x0000014FE3E50EA0>
    └ <module 'asyncio' from 'C:\\Users\\kevin\\AppData\\Roaming\\uv\\python\\cpython-3.11.11-windows-x86_64-none\\Lib\\asyncio\\__...

  File "C:\Users\kevin\AppData\Roaming\uv\python\cpython-3.11.11-windows-x86_64-none\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object DocumentWriter.process_document at 0x0000014FE72EC8C0>
           │      └ <function Runner.run at 0x0000014FE3ED4FE0>
           └ <asyncio.runners.Runner object at 0x0000014FE72F19D0>
  File "C:\Users\kevin\AppData\Roaming\uv\python\cpython-3.11.11-windows-x86_64-none\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │                        └ <Task finished name='Task-1' coro=<DocumentWriter.process_document() done, defined at C:\Users\kevin\repos\document_writer\sr...
           │    └ None
           └ <asyncio.runners.Runner object at 0x0000014FE72F19D0>
  File "C:\Users\kevin\AppData\Roaming\uv\python\cpython-3.11.11-windows-x86_64-none\Lib\asyncio\base_events.py", line 654, in run_until_complete
    return future.result()
           │      └ <method 'result' of '_asyncio.Task' objects>
           └ <Task finished name='Task-1' coro=<DocumentWriter.process_document() done, defined at C:\Users\kevin\repos\document_writer\sr...

  File "C:\Users\kevin\repos\document_writer\src\document_writer.py", line 143, in process_document
    while await self.expansion_loop(doc_state):
                │    │              └ DocumentState(content="\n## Content from Ukraine war latest: 'Extremely fierce battles' as Kyiv's troops try to ...\n\nThe ma...
                │    └ <function DocumentWriter.expansion_loop at 0x0000014FE71D2CA0>
                └ <src.document_writer.DocumentWriter object at 0x0000014FE6F80F10>

  File "C:\Users\kevin\repos\document_writer\src\document_writer.py", line 68, in expansion_loop
    feedback = await self.judge_agent.review_document(doc_state, EditorResponse(
                     │    │           │               │          └ <class 'src.models.EditorResponse'>
                     │    │           │               └ DocumentState(content="\n## Content from Ukraine war latest: 'Extremely fierce battles' as Kyiv's troops try to ...\n\nThe ma...
                     │    │           └ <function JudgeAgent.review_document at 0x0000014FE71D1260>
                     │    └ <src.agents.judge.JudgeAgent object at 0x0000014FE72B6C90>
                     └ <src.document_writer.DocumentWriter object at 0x0000014FE6F80F10>

  File "C:\Users\kevin\repos\document_writer\src\agents\judge.py", line 71, in review_document
    response = await self.client.chat.completions.create(
                     │    │      │    │           └ <function AsyncCompletions.create at 0x0000014FE710EB60>
                     │    │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x0000014FE559A150>
                     │    │      └ <openai.resources.chat.chat.AsyncChat object at 0x0000014FE72E8450>
                     │    └ <openai.AsyncOpenAI object at 0x0000014FE72B6D50>
                     └ <src.agents.judge.JudgeAgent object at 0x0000014FE72B6C90>

  File "C:\Users\kevin\repos\document_writer\.venv\Lib\site-packages\openai\resources\chat\completions.py", line 1702, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x0000014FE72B6D50>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x0000014FE559A150>
  File "C:\Users\kevin\repos\document_writer\.venv\Lib\site-packages\openai\_base_client.py", line 1849, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x0000014FE6E19440>
                 └ <openai.AsyncOpenAI object at 0x0000014FE72B6D50>
  File "C:\Users\kevin\repos\document_writer\.venv\Lib\site-packages\openai\_base_client.py", line 1543, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x0000014FE6E194E0>
                 └ <openai.AsyncOpenAI object at 0x0000014FE72B6D50>
  File "C:\Users\kevin\repos\document_writer\.venv\Lib\site-packages\openai\_base_client.py", line 1644, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x0000014FE6E125C0>
          └ <openai.AsyncOpenAI object at 0x0000014FE72B6D50>

openai.BadRequestError: Error code: 400 - {'error': {'message': "Missing required parameter: 'response_format.json_schema'.", 'type': 'invalid_request_error', 'param': 'response_format.json_schema', 'code': 'missing_required_parameter'}}
2025-01-23 23:22:10.638 | INFO     | src.services.document:save_version:109 - Saved document version to _workproduct\01_initial_research_latest_news_from_ukraine_war_20250123_232210.md
2025-01-23 23:22:11.092 | ERROR    | src.agents.judge:review_document:89 - Error during document review: Error code: 400 - {'error': {'message': "Invalid schema for response_format 'JudgeReviewResponse': In context=('properties', 'decision'), 'pattern' is not permitted.", 'type': 'invalid_request_error', 'param': 'response_format', 'code': None}}
2025-01-23 23:22:11.093 | ERROR    | src.document_writer:expansion_loop:90 - Error in expansion loop: Error code: 400 - {'error': {'message': "Invalid schema for response_format 'JudgeReviewResponse': In context=('properties', 'decision'), 'pattern' is not permitted.", 'type': 'invalid_request_error', 'param': 'response_format', 'code': None}}
2025-01-23 23:22:11.093 | ERROR    | src.document_writer:process_document:154 - Error during document processing: Error code: 400 - {'error': {'message': "Invalid schema for response_format 'JudgeReviewResponse': In context=('properties', 'decision'), 'pattern' is not permitted.", 'type': 'invalid_request_error', 'param': 'response_format', 'code': None}}
2025-01-23 23:22:11.095 | ERROR    | __main__:create_document:57 - Error in document creation
Traceback (most recent call last):

  File "c:\Users\kevin\repos\document_writer\src\main.py", line 102, in <module>
    main()
    └ <function main at 0x0000012A51DB2FC0>

  File "c:\Users\kevin\repos\document_writer\src\main.py", line 92, in main
    create_document()
    └ <function create_document at 0x0000012A51DB2E80>

> File "c:\Users\kevin\repos\document_writer\src\main.py", line 54, in create_document
    asyncio.run(writer.process_document(topic))
    │       │   │      │                └ 'latest news from Ukraine War'
    │       │   │      └ <function DocumentWriter.process_document at 0x0000012A51DB2D40>
    │       │   └ <src.document_writer.DocumentWriter object at 0x0000012A51DAB010>
    │       └ <function run at 0x0000012A4EAA0EA0>
    └ <module 'asyncio' from 'C:\\Users\\kevin\\AppData\\Roaming\\uv\\python\\cpython-3.11.11-windows-x86_64-none\\Lib\\asyncio\\__...

  File "C:\Users\kevin\AppData\Roaming\uv\python\cpython-3.11.11-windows-x86_64-none\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object DocumentWriter.process_document at 0x0000012A51EA47B0>
           │      └ <function Runner.run at 0x0000012A4EB14FE0>
           └ <asyncio.runners.Runner object at 0x0000012A51DCCC90>
  File "C:\Users\kevin\AppData\Roaming\uv\python\cpython-3.11.11-windows-x86_64-none\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │                        └ <Task finished name='Task-1' coro=<DocumentWriter.process_document() done, defined at C:\Users\kevin\repos\document_writer\sr...
           │    └ None
           └ <asyncio.runners.Runner object at 0x0000012A51DCCC90>
  File "C:\Users\kevin\AppData\Roaming\uv\python\cpython-3.11.11-windows-x86_64-none\Lib\asyncio\base_events.py", line 654, in run_until_complete
    return future.result()
           │      └ <method 'result' of '_asyncio.Task' objects>
           └ <Task finished name='Task-1' coro=<DocumentWriter.process_document() done, defined at C:\Users\kevin\repos\document_writer\sr...

  File "C:\Users\kevin\repos\document_writer\src\document_writer.py", line 143, in process_document
    while await self.expansion_loop(doc_state):
                │    │              └ DocumentState(content='\n## Content from Ukraine war latest: \'Extremely fierce battles\' as Kyiv\'s troops try to ...\n\nThe...
                │    └ <function DocumentWriter.expansion_loop at 0x0000012A51DB2C00>
                └ <src.document_writer.DocumentWriter object at 0x0000012A51DAB010>

  File "C:\Users\kevin\repos\document_writer\src\document_writer.py", line 68, in expansion_loop
    feedback = await self.judge_agent.review_document(doc_state, EditorResponse(
                     │    │           │               │          └ <class 'src.models.EditorResponse'>
                     │    │           │               └ DocumentState(content='\n## Content from Ukraine war latest: \'Extremely fierce battles\' as Kyiv\'s troops try to ...\n\nThe...
                     │    │           └ <function JudgeAgent.review_document at 0x0000012A51DB11C0>
                     │    └ <src.agents.judge.JudgeAgent object at 0x0000012A51EA1050>
                     └ <src.document_writer.DocumentWriter object at 0x0000012A51DAB010>

  File "C:\Users\kevin\repos\document_writer\src\agents\judge.py", line 67, in review_document
    completion = await self.client.beta.chat.completions.parse(
                       │    │      │    │    │           └ <function AsyncCompletions.parse at 0x0000012A51BA68E0>
                       │    │      │    │    └ <openai.resources.beta.chat.completions.AsyncCompletions object at 0x0000012A51B5ED10>
                       │    │      │    └ <openai.resources.beta.chat.chat.AsyncChat object at 0x0000012A51DDA850>
                       │    │      └ <openai.resources.beta.beta.AsyncBeta object at 0x0000012A51EA2D50>
                       │    └ <openai.AsyncOpenAI object at 0x0000012A51EA1090>
                       └ <src.agents.judge.JudgeAgent object at 0x0000012A51EA1050>

  File "C:\Users\kevin\repos\document_writer\.venv\Lib\site-packages\openai\resources\beta\chat\completions.py", line 435, in parse
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x0000012A51EA1090>>
                 └ <openai.resources.beta.chat.completions.AsyncCompletions object at 0x0000012A51B5ED10>
  File "C:\Users\kevin\repos\document_writer\.venv\Lib\site-packages\openai\_base_client.py", line 1849, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ None
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers={'X-Stainless-Helper-Method': 'beta.chat.compl...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x0000012A519F93A0>
                 └ <openai.AsyncOpenAI object at 0x0000012A51EA1090>
  File "C:\Users\kevin\repos\document_writer\.venv\Lib\site-packages\openai\_base_client.py", line 1543, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x0000012A519F9440>
                 └ <openai.AsyncOpenAI object at 0x0000012A51EA1090>
  File "C:\Users\kevin\repos\document_writer\.venv\Lib\site-packages\openai\_base_client.py", line 1644, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x0000012A519EE520>
          └ <openai.AsyncOpenAI object at 0x0000012A51EA1090>

openai.BadRequestError: Error code: 400 - {'error': {'message': "Invalid schema for response_format 'JudgeReviewResponse': In context=('properties', 'decision'), 'pattern' is not permitted.", 'type': 'invalid_request_error', 'param': 'response_format', 'code': None}}
